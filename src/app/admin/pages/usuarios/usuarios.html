<section class="max-w-6xl mx-auto p-6">
  <h2 class="text-3xl font-bold mb-6 text-gray-800 flex items-center gap-3">
    <span class="text-blue-600">üë•</span> Gesti√≥n de Usuarios
  </h2>

  <!-- Formulario mejorado -->
  <div class="bg-white p-8 rounded-lg shadow-lg mb-8 border border-gray-200">
    <h3 class="text-xl font-semibold mb-6 text-gray-700 flex items-center gap-2">
      <span>{{ modoEditar ? '‚úèÔ∏è' : '‚ûï' }}</span>
      {{ modoEditar ? 'Editar Usuario' : 'Crear Nuevo Usuario' }}
    </h3>
    
    <form [formGroup]="form" (ngSubmit)="guardar()" class="space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Nombre Completo -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            <span class="text-red-500">*</span> Nombre Completo
          </label>
          <input 
            type="text" 
            formControlName="nombreCompleto" 
            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
            placeholder="Ingrese el nombre completo"
            [class.border-red-500]="form.get('nombreCompleto')?.invalid && form.get('nombreCompleto')?.touched"
          />
          <div *ngIf="form.get('nombreCompleto')?.invalid && form.get('nombreCompleto')?.touched" 
               class="text-red-500 text-sm mt-1">
            El nombre completo es requerido
          </div>
        </div>

        <!-- Correo Electr√≥nico -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            <span class="text-red-500">*</span> Correo Electr√≥nico
          </label>
          <input 
            type="email" 
            formControlName="correo" 
            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
            placeholder="usuario@ejemplo.com"
            [class.border-red-500]="form.get('correo')?.invalid && form.get('correo')?.touched"
          />
          <div *ngIf="form.get('correo')?.invalid && form.get('correo')?.touched" 
               class="text-red-500 text-sm mt-1">
            Ingrese un correo electr√≥nico v√°lido
          </div>
        </div>

        <!-- Contrase√±a -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            <span class="text-red-500" *ngIf="!modoEditar">*</span> 
            Contrase√±a
            <span *ngIf="modoEditar" class="text-gray-500 text-xs">(dejar vac√≠o para mantener actual)</span>
          </label>
          <input 
            type="password" 
            formControlName="contrasena" 
            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
            [class.border-red-500]="form.get('contrasena')?.invalid && form.get('contrasena')?.touched"
          />
          <div *ngIf="form.get('contrasena')?.invalid && form.get('contrasena')?.touched" 
               class="text-red-500 text-sm mt-1">
            La contrase√±a es requerida
          </div>
        </div>

        <!-- Rol -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            <span class="text-red-500">*</span> Rol
          </label>
          <select 
            formControlName="rolId" 
            class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
            [class.border-red-500]="form.get('rolId')?.invalid && form.get('rolId')?.touched"
          >
            <option value="" disabled>Selecciona un rol</option>
            <option *ngFor="let rol of roles" [value]="rol.id">
              {{ rol.nombre }}
            </option>
          </select>
          <div *ngIf="form.get('rolId')?.invalid && form.get('rolId')?.touched" 
               class="text-red-500 text-sm mt-1">
            Debe seleccionar un rol
          </div>
        </div>
      </div>

      <!-- Botones -->
      <div class="flex gap-4 pt-4">
        <button 
          type="submit" 
          [disabled]="form.invalid"
          class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition flex items-center gap-2 font-medium"
        >
          <span>{{ modoEditar ? 'üíæ' : '‚ûï' }}</span>
          {{ modoEditar ? 'Actualizar Usuario' : 'Crear Usuario' }}
        </button>
        
        <button 
          type="button" 
          *ngIf="modoEditar" 
          (click)="resetForm()" 
          class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition flex items-center gap-2 font-medium"
        >
          <span>‚ùå</span> Cancelar
        </button>
      </div>
    </form>
  </div>

  <!-- Tabla mejorada -->
  <div class="bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200">
    <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
      <h3 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
        <span>üìã</span> Lista de Usuarios
        <span class="bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full ml-auto">
          Total: {{ usuarios.length }}
        </span>
      </h3>
    </div>
    
    <div class="overflow-x-auto">
      <table class="w-full">
        <thead class="bg-gray-100">
          <tr>
            <th class="px-6 py-4 text-left text-sm font-medium text-gray-700">Usuario</th>
            <th class="px-6 py-4 text-left text-sm font-medium text-gray-700">Correo</th>
            <th class="px-6 py-4 text-left text-sm font-medium text-gray-700">Rol</th>
            <th class="px-6 py-4 text-left text-sm font-medium text-gray-700">Fecha Registro</th>
            <th class="px-6 py-4 text-center text-sm font-medium text-gray-700">Acciones</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <tr *ngFor="let usuario of usuarios; let i = index" 
              class="hover:bg-gray-50 transition">
            <td class="px-6 py-4">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                  <span class="text-blue-600 font-semibold text-sm">
                    {{ usuario.nombreCompleto.charAt(0).toUpperCase() }}
                  </span>
                </div>
                <div>
                  <div class="font-medium text-gray-900">{{ usuario.nombreCompleto }}</div>
                  <div class="text-sm text-gray-500">ID: {{ usuario.id }}</div>
                </div>
              </div>
            </td>
            <td class="px-6 py-4 text-sm text-gray-900">{{ usuario.correo }}</td>
            <td class="px-6 py-4">
              <span class="bg-purple-100 text-purple-800 text-xs px-3 py-1 rounded-full font-medium">
                {{ usuario.rol?.nombre || 'Sin Rol' }}
              </span>
            </td>
            <td class="px-6 py-4 text-sm text-gray-500">
              {{ usuario.fechaRegistro | date:'short' }}
            </td>
            <td class="px-6 py-4">
              <div class="flex items-center justify-center gap-2">
                <button 
                  (click)="editar(usuario)" 
                  class="bg-blue-100 text-blue-700 px-3 py-1 rounded-lg hover:bg-blue-200 transition text-sm font-medium flex items-center gap-1"
                >
                  <span>‚úèÔ∏è</span> Editar
                </button>
                <button 
                  (click)="eliminar(usuario.id)" 
                  class="bg-red-100 text-red-700 px-3 py-1 rounded-lg hover:bg-red-200 transition text-sm font-medium flex items-center gap-1"
                >
                  <span>üóëÔ∏è</span> Eliminar
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Estado vac√≠o -->
    <div *ngIf="usuarios.length === 0" class="text-center py-12 text-gray-500">
      <div class="text-6xl mb-4">üë§</div>
      <p class="text-lg font-medium">No hay usuarios registrados</p>
      <p class="text-sm">Crea el primer usuario usando el formulario de arriba</p>
    </div>
  </div>
</section>
